/*!
  * wia router v1.0.18
  * (c) 2014 Sibyl Yu
  * Licensed under the Elastic License 2.0.
  * You may not use this file except in compliance with the Elastic License.
  */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self)["@wiajs/router"]=t()}(this,function(){"use strict";function e(e,t,s,a,i,r,l){try{var n=e[r](l),o=n.value}catch(e){s(e);return}n.done?t(o):Promise.resolve(o).then(a,i)}function t(t){return function(){var s=this,a=arguments;return new Promise(function(i,r){var l=t.apply(s,a);function n(t){e(l,i,r,n,o,"next",t)}function o(t){e(l,i,r,n,o,"throw",t)}n(void 0)})}}function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e}).apply(this,arguments)}let a=window.$,i=window.location,r={wx:7,ms:11,fs:16},l={el:"#wia-app",view:"wia-view",style:"wia-style",splashTime:1e3,className:"page",nextClass:"page-next",prevClass:"page-previous",showClass:"page-current",cos:"https://cos.wia.pub",ver:"1.0.2",mode:"local",transition:"f7-flip",api:{host:"https://wia.pub",token:"auth/login",login:"auth/login",logout:"auth/logout",getCode:"auth/getCode",getToken:"auth/getToken",checkToken:"auth/checkToken",userInfo:"user/info"}},n=class{go(e,t=null,s=!1){e=e||"index",e=this.repairUrl(e),o(i.href)===e?(this.nextHash=e,this.hash.length&&this.hash[this.hash.length-1]===this.nextHash||this.hash.push(this.nextHash),this.routeTo(e,t,s)):this.setHash(e,t,s)}repairUrl(e){let t="",{opt:s}=this;if(!e)return"";try{if(t=e,"codecamp"===e)t="/nuoya/camp/course/";else if("~"===e)this.owner&&this.appName&&(t=this.owner===s.owner&&this.appName===s.name?"":`/${this.owner}/${this.appName}/`);else if(e.startsWith("../")){let{path:s}=this,a=this.path.lastIndexOf("/");a>-1?(s=s.substring(0,a),s=(a=this.path.lastIndexOf("/"))>-1?s.substring(0,a):""):s="",t=""===s?`/${this.owner}/${this.appName}/${e.substr(3)}`:`/${this.owner}/${this.appName}/${s}/${e.substr(3)}`}else if(e.startsWith("./")&&this.path){let{path:s}=this,a=this.path.lastIndexOf("/");a>-1?(s=s.substring(0,a),t=`/${this.owner}/${this.appName}/${s}/${e.slice(2)}`):t=`/${this.owner}/${this.appName}/${e.slice(2)}`}else if(e.startsWith("/")){if(e.startsWith("/")){let s=e.match(/([^/?]+)\/([^/?]+)\/?([^?]*)([\s\S]*)/);if(s){let e=s[1],a=s[2],i=s[3];e&&a&&!i&&(t=`/${e}/${a}/${s[4]}`)}}}else t=this.owner&&this.appName?`/${this.owner}/${this.appName}/${e}`:this.opt.owner&&this.opt.name?`/${this.opt.owner}/${this.opt.name}/${e}`:`/${e}`;t.endsWith("/index")&&(t=t.replace(/\/index$/,"/")),RegExp(`^/${s.owner}/${s.name}/$`).test(t)&&(t="")}catch(e){}return t}back(e,t=!1){var s;if((null==(s=this.hash)?void 0:s.length)>1){let s=this.hash[this.hash.length-2];this.param[s]=e,this.refresh[s]=t}window.history.back()}loaded(e){return a.id(e.id)||this.vs[e.id]}load(e,s){var i=this;return t(function*(){let t;let{opt:r}=i;try{""===e?r.owner&&r.name&&(e=`/${r.owner}/${r.name}/index`):e.endsWith("/")?e+="index":e.includes("/?")&&(e=e.replace("/?","/index?"));let l=e.match(/([^/]+)\/([^/]+)\/?([^?]*)/),n=null==l?void 0:l[1],o=null==l?void 0:l[2],p=null==l?void 0:l[3];if(n&&o&&!p&&(p="index"),!n||!o||!p)throw Error("need owner|name|path");if(!i.findApp(n,o)){yield i.switchApp(n,o,p,s);return}if("local"===r.mode){let e=new Promise((e,t)=>{let l=`${r.cos}/page/${p}.html?v=${Date.now()}`;a.get(l).then(t=>{var a,r;let l=new(null!=(r=null==(a=i.pages)?void 0:a[`./page/${p}`])?r:__webpack_require__(`./src/page/${p}.js`).default)({app:i.app});l.opt,l.html=i.vite?t.replace('<script type="module" src="/@vite/client"></script>',""):t,l.param=s,l.owner=n,l.appName=o,l.url=`/${n}/${o}/${p}`,l.path=p,i.cachePage(l),e(l)},e=>t(e))}),l=new Promise((e,t)=>{let s=`${r.cos}/page/${p}.css?v=${Date.now()}`;i.vite?import(`${r.cos}/page/${p}.css`).then(t=>e(t)).catch(e=>t(e)):a.get(s).then(t=>{e(t)},t=>e(""))}),h=yield Promise.all([e,l]),d=h[0];d.css=h[1],d.load&&d.load(s||{}),t=d}else{e=r.cos.includes("localhost:")?`${r.cos}/page/${p}.zip?v=${Date.now()}`:`${r.cos}/${n}/${o}/page/${p}.zip?v=${Date.now()}`;let l=yield h(e);if(null==l?void 0:l.js){let e=`${n}/${o}/page/${p}.js`;l.js[e],a.M.m[e]||a.M.add(l.js);let r=new(a.M(e)).default({app:i.app});r.opt,r.html=l.html,r.css=l.css,r.param=s,r.owner=n,r.appName=o,r.url=`/${n}/${o}/${p}`,r.path=p,i.cachePage(r),r.load&&r.load(s||{}),t=r}}}catch(e){}return t})()}createApp(e,s){var i=this;return t(function*(){let t;let{opt:r}=i;try{let o=i.findApp(e,s);if(o)return o;let p=null;if("local"===r.mode){var l,n;e===r.owner&&(p=null!=(n=null==(l=i.pages)?void 0:l["./src/index"])?n:__webpack_require__("./src/index.js").default)}else{let t=`${e}/${s}/index.js`;if(!a.M.m[t]){let t;t=r.cos.includes("localhost:")?`${r.cos}/index.zip?v=${Date.now()}`:`${r.cos}/${e}/${s}/index.zip?v=${Date.now()}`;let i=yield h(t);(null==i?void 0:i.js)&&a.M.add(i.js)}a.M.m[t]&&(p=a.M(t).default)}p&&(o=new p({el:r.el||r.root,init:i.init,owner:e,name:s}),i.app=o,i.init=!1,i.apps[`${e}.${s}`]=o,o.ready&&a.nextTick(()=>{o.ready()}),t=o)}catch(e){}return t})()}showApp(e,s){var r=this;return t(function*(){let{cfg:l}=e,{home:n}=l;try{if((null==s?void 0:s.loginType)===7&&(null==s?void 0:s.from)==="qr"){let{sid:e,code:t}=s,{appid:a,url:r,scope:n,authSucc:o}=l.wx,{redirect:h}=l.wx,p=encodeURIComponent(`hash=${o}&sid=${e}&from=wx&loginType=7&verifier=${t}`);h=encodeURIComponent(h);let d=`${r}?appid=${a}&redirect_uri=${h}&response_type=code&scope=${n}&state=${p}#wechat_redirect`;i.href=d;return}a.nextTick(t(function*(){var t,i,o,h,p;let{hash:d}=window.location;if(d.startsWith("#")&&(d=d.substring(1)),d.startsWith("!")&&(d=d.substring(1)),!s&&d&&(s=a.urlParam(d)),null==e?void 0:e.show)try{let t=yield e.show(d,s||{});t&&({hash:d,param:s}=t)}catch(e){}a.view.qus('a[href=""]').attr("href","javascript:;");let{from:c,to:u,code:m,verifier:g,appid:w,sid:f,master:v,login:$,bindMobile:y,loginType:x}=s||{};w=null!=w?w:l.appid,f=null!=f?f:l.sid,v=null!=(i=null!=v?v:l.master)?i:"",$=null!=(o=null!=$?$:l.login)&&o,y=null!=(h=null!=y?y:l.bindMobile)&&h,u=u||d||n||"index",f&&(f=Number.parseInt(f)),w&&(w=Number.parseInt(w));let C=yield r.getToken(e,f,m,x,g);if(f&&(a.app.sid=f),w&&(a.app.id=w),C){let e=a.app.user;!l.bindMobile||(null==e?void 0:e.mobile)?!v||(null==(p=r.view.qu(".page-master"))?void 0:p.dom)?r.go(u,s):r.go(v,{to:u,param:s}):r.go("login",{master:v,to:u,param:s})}else!m&&a.device.wx&&l.wx.autoAuth?r.wxAuth(e,d,s):$?r.go("login",{master:v,to:u,param:s}):!v||(null==(t=r.view.qu(".page-master"))?void 0:t.dom)?u&&r.go(u,s):r.go(v,{to:u,param:s})}))}catch(e){}})()}wxAuth(e,t,s){let{cfg:i}=e;try{var r;let e="wxAuthCnt",l=null!=(r=a.store.get(e))?r:0;if(""===l&&(l=0),l=Number.parseInt(l),l++,a.store.set(e,l,1),l<=i.wx.autoAuth){"object"==typeof s&&Object.keys(s).length&&(s=JSON.stringify(s)),s=null!=s?s:"";let e="";(t||s)&&(e=encodeURIComponent(`hash=${t}&auth=wx&param=${s}`));let a=encodeURIComponent(i.wx.redirect),r=`${i.wx.url}?appid=${i.wx.appid}&redirect_uri=${a}&response_type=code&scope=${i.wx.scope}&state=${e}#wechat_redirect`;window.location.href=r}}catch(e){}}switchApp(e,s,i,r){var l=this;return t(function*(){let t=!1;try{if(e===l.owner&&s===l.appName)return i&&i!==l.path&&(l.path=i),!0;{e&&(l.owner!==l.lastOwner&&(l.lastOwner=l.owner),l.owner=e),s&&(l.appName!==l.lastName&&(l.lastName=l.appName),l.appName=s),i&&(l.path!==l.lastPath&&(l.lastPath=l.path),l.path=i);let n=l.findApp(e,s);if(n||(n=yield l.createApp(e,s)),n){if(l.lastApp){let e=l.lastApp;e.hide&&a.nextTick(()=>{e.hide()})}l.app&&(l.lastApp=l.app),l.app=n,a.app=n,l.lastPage=null,l.page=null,a.lastPage=null,a.page=null,yield l.showApp(n,r),t=!0}}}catch(e){}return t})()}getToken(e,s,i,l,n){var o=this;return t(function*(){let t="",{opt:h}=o,{cfg:p}=e;try{let c=a.store.get(p.token);if(!c&&(c=a.store.get(`nuoya/camp/${p.token}`))&&a.store.set(p.token,c),c){let s=a._user?a._user:yield o.getUser(e,c);s?(a._user||(a._user=s),e.user=s,t=c):0===s?t=c:a.store.remove(p.token)}if(!t&&s&&i){let u,m=null!=l?l:r.wx;m=Number.parseInt(l);let g=`${p[p.mode].api}/${h.api.token}`;m===r.wx&&n&&(u="qr"),[r.ms,r.fs].includes(m)&&(n=a.store.get("codeVerifier"));let w=yield a.post(g,{sid:s,code:i,verifier:n,from:u,type:m});if(w){var d;if(200===w.code&&(null==(d=w.data)?void 0:d.token)){c=w.data.token,a.store.set(p.token,c);let s=yield o.getUser(e,c);s?(a._user=s,a.app.user=s,t=c):a.store.remove(p.token)}}}}catch(e){}return t})()}getUser(e,s){var i=this;return t(function*(){let t=null,{cfg:r}=e;try{let e=`${r[r.mode].api}/${i.opt.api.userInfo}`,l=yield a.post(e,null,{"x-wia-token":s});l&&200===l.code&&(t=l.data)}catch(e){0===e.status&&(t=0)}return t})()}checkToken(e,s){var i=this;return t(function*(){let t=!1,{cfg:r}=e;try{if(!s)return!1;let e=yield a.get(`${r[r.mode].api}/${i.opt.api.checkToken}`,`token=${s}`);200===e.code&&(e.data.expire,t=e.data.res)}catch(e){}return t})()}getCode(e,s){var i=this;return t(function*(){let t="",{cfg:r}=e;try{let e=a.get(`${r[r.mode].api}/${i.opt.api.getCode}`,`token=${s}`);200===e.code&&(t=e.data)}catch(e){}return t})()}addHtml(e,t=!0){let s;let a=this;try{s=new Promise((s,i)=>{if(!e)return i();let r=e.getElementsByTagName("script"),l=[];if(r.length)for(let e of Array.from(r))e.src&&(l.push(e.src),e.remove());t?a.view.dom.appendChild(e):a.view.dom.insertBefore(e,a.view.lastChild().dom),l.length?function e(t,s,a,i){if(t>=a.length)return i();let r=document.createElement("script");r.src=a[t],r.onload=()=>{e(t+1,s,a,i)},r.onerror=()=>{e(t+1,s,a,i)},s.appendChild(r)}(0,e,l,s):s()})}catch(e){}return s}addCss(e){if(e.css){let t=`css-${e.id}`,s=a.id(t);s||((s=document.createElement("style")).id=t,s.innerHTML=e.css,a("head").append(s))}}removeCss(e){let t=`css-${e.id}`,s=a.id(t);s&&a(s).remove()}routeTo(e,t,s=!1,i=""){let r=this;(s=null!=s&&s)||null==t||!t.refresh||(s=!0,delete t.refresh),!i&&(null==t?void 0:t.lastHash)&&(i=t.lastHash,delete t.lastHash);let l=r.findPage(e,t,s);if(l){var n,o;let{master:h,login:p}=l.opt||{};p?(t||(t={}),s&&(t.refresh=!0),i&&(t.lastHash=i),a.app.user?!h||(null==(n=r.view.qu(".page-master"))?void 0:n.dom)?r.to(l,s,i):r.go(h,{to:e,param:t}):r.go("login",{master:h,to:e,param:t})):!h||(null==(o=r.view.qu(".page-master"))?void 0:o.dom)?r.to(l,s,i):r.go(h,{to:e,param:t})}else this.load(e,t).then(n=>{if(l=r.findPage(e,t,s)){var o,h;let{master:n,login:p}=l.opt||{};p?(t||(t={}),s&&(t.refresh=!0),i&&(t.lastHash=i),a.app.user?!n||(null==(o=r.view.qu(".page-master"))?void 0:o.dom)?r.to(l,s,i):r.go(n,{to:e,param:t}):r.go("login",{master:n,to:e,param:t})):!n||(null==(h=r.view.qu(".page-master"))?void 0:h.dom)?r.to(l,s,i):r.go(n,{to:e,param:t})}})}to(e,t=!1,s=""){let i=this;e&&i.switchApp(e.owner,e.appName,e.path).then(r=>{if(r){var l,n,o;this.lastPage=this.page,this.lastPage&&this.lastPage.scrollTop&&(this.lastPage.scrollTop=null!=(o=null==(n=this.lastPage.view.class("page-content"))?void 0:null==(l=n.dom)?void 0:l.scrollTop)?o:0),this.page=e,a.page=this.page,a.lastPage=this.lastPage;let{ids:r}=this;this.backed=!1,r.length>1&&r[r.length-2]===e.id?(this.backed=!0,r.pop()):r.length>0&&r[r.length-1]===e.id?e.change&&e.search!==e.lastSearch&&a.nextTick(()=>{try{e.change(e.view,e.search,e.lastSearch)}catch(e){}}):(0===r.length||r.length>0&&r[r.length-1]!==e.id)&&(r.length,r.push(e.id));let h=t=>{e.doReady=!1;let r=a.id(e.id);if(r)this.showHtml(e,r,s);else if((r=this.vs[e.id])||!t||(r=t,this.vs[e.id]=r,e.doReady=!0),r&&this.view){this.vite||this.addCss(e);let t=a(r),l=t.hasClass("page-master");(this.backed||l)&&this.view.hasChild()?(this.opt.className&&t.addClass(`${this.opt.className}`),this.opt.prevClass&&!l&&t.addClass(`${this.opt.prevClass}`),this.addHtml(r,!1).then(()=>i.showHtml(e,r,s))):(this.opt.className&&t.addClass(`${this.opt.className}`),this.opt.nextClass&&!l&&t.addClass(`${this.opt.nextClass}`),this.addHtml(r).then(()=>i.showHtml(e,r,s)))}};if(t){let t=a.id(e.id);t&&a.remove(t),(t=this.vs[e.id])&&delete this.vs[e.id]}this.loaded(e)?h():((t,s="")=>{if(t)throw t;let i=a(s,!0);i.dom.id=e.id,e.view=i,e.$el=i,e.el=i.dom,e.dom=i.dom,this.vps.set(e.dom,e),h(e.dom)})(null,e.html)}}).catch(e=>void 0)}showHtml(e,t,s){var i,r;e.el!==t&&(e.el=t),e.dom!==t&&(e.dom=t),(null==(i=e.$el)?void 0:i.dom)!==t&&(e.$el=a(t,!0)),(null==(r=e.view)?void 0:r.dom)!==t&&(e.view=e.$el),this.nextHash&&this.nextHash!==this.hash[this.hash.length-1]||this.switchPage(e,this.backed,s)}parseUrl(e=""){let t={url:e};try{let s=e.indexOf("?");s>=0&&(t.url=e.slice(0,s),t.search=e.slice(s+1),t.search&&(t.param={},t.search.split("&").forEach(e=>{(s=e.indexOf("="))>0&&(t.param[e.substr(0,s)]=e.substr(s+1))}))),RegExp(`/${this.opt.owner}/${this.opt.name}/\\S*index$`).test(t.url)||(t.url=this.repairUrl(t.url));let a=e.match(/([^/]+)\/([^/]+)\/([^?]+)/);a&&(t.path=a[3]),t.url}catch(e){}return t}findPage(e,t,i=!1){let r=null,l=this.parseUrl(e);this.opt.owner&&this.opt.name&&""===l.url?l.url=`/${this.opt.owner}/${this.opt.name}/index`:l.url.endsWith("/")?l.url+="index":l.url.includes("/?")&&(l.url=e.replace("/?","/index?"));let n=this.ps[l.url];return n&&(l.param?n.param=s({},l.param):n.param={},t&&a.assign(n.param,t),n.lastSearch=n.search,n.search=l.search,n.refresh=i,r=n),r}findApp(e,t,s,i=!1){let r=null,l=this.apps[`${e}.${t}`];return l&&(l.param={},s&&a.assign(l.param,s),l.reload=i,r=l),r}cachePage(e){try{if(!e)throw Error("page is empty!");if(!e.url)throw Error("page's url is empty!");return e.id=`${e.url.replace(/\//g,"-")}`,e.id.startsWith("-")&&(e.id=e.id.substr(1)),e.ready=e.ready||a.noop,e.router=this,this.ps[e.url]=e,this}catch(e){}}aniPage(e,t,s,i){let r=`router-transition-${s||"forward"} router-transition`;if(a.device.ios)t.animationEnd(()=>{this.view.removeClass(r),i&&i()});else{let a=t;"backward"===s&&(a=e),a.animationEnd(()=>{this.view.removeClass(r),i&&i()})}this.view.addClass(r)}hidePage(e,t){if(t&&e)try{t.removeClass(this.opt.showClass),t.removeClass(this.opt.prevClass),t.removeClass(this.opt.nextClass);try{e.hide&&e.hide(t)}catch(e){}t.remove(),this.removeCss(e)}catch(e){}}onShow(e,t){try{if(!e)return;let s=e.view;e.doReady&&e.ready&&a.nextTick(()=>{try{e.ready(s,e.param||{},this.backed,t)}catch(e){}this.pageEvent("init",e,s),a.fastLink()}),e.back&&this.backed&&a.nextTick(()=>{try{var a,i,r;(null==(i=s.class("page-content"))?void 0:null==(a=i.dom)?void 0:a.scrollTop)&&(s.class("page-content").dom.scrollTop=null!=(r=e.scrollTop)?r:0),e.back(s,e.param||{},t)}catch(e){}}),e.show&&!this.backed&&a.nextTick(()=>{try{e.show(s,e.param||{},t)}catch(e){}})}catch(e){}}showPage(e){if(e){let t=e.view;t.removeClass(this.opt.nextClass),t.removeClass(this.opt.prevClass),t.hasClass("page-master")||t.hasClass("page-master-detail")?this.view.addClass("view-master-detail"):this.view.hasClass("view-master-detail")&&this.view.removeClass("view-master-detail"),t.hasClass("page-master")||t.addClass(this.opt.showClass)}}switchPage(e,t,s){if(e)try{var i,r,l;let n=null,o=this.getCurrentPage();o&&((o=a(o)).hasClass("page-master")?o=null:n=this.vps.get(o.dom));let h=a.id(e.id);if(h&&(h=e.view).hasClass("page-master")&&(o=null),o&&h&&o.dom===h.dom)return;if((o||h)&&(o&&h?this.noAni?(this.noAni=!1,this.hidePage(n,o),this.onShow(e,s),this.showPage(e)):(this.onShow(e,s),this.aniPage(o,h,t?"backward":"forward",()=>{this.hidePage(n,o),this.showPage(e)})):o?this.hidePage(n,o):h&&(this.onShow(e,s),this.showPage(e))),i=this.page.title,document.title!==i&&(document.title=i),this.hash.length>0){let[e]=this.hash.slice(-1);(null==(r=this.param)?void 0:r[e])&&delete this.param[e],(null==(l=this.refresh)?void 0:l[e])&&delete this.param[e]}}catch(e){}}pageEvent(e,t,s){try{if(!t||!s||!s.length)return;let a=`page${e[0].toUpperCase()+e.slice(1,e.length)}`,i=`page:${e.toLowerCase()}`,r={$el:s,el:s.dom};if("init"===e){if(s[0].f7PageInitialized){s.trigger("page:reinit",r),this.app.emit("pageReinit",r);return}s[0].f7PageInitialized=!0,s.trigger(i,r),this.app.emit(`local::${a}`,r)}}catch(e){}}setHash(e,t=null,s=!1){i.hash=e,""===e&&history.replaceState(null,"",i.pathname+i.search),t&&(this.param||(this.param={}),this.param[e]=t),s&&(this.refresh||(this.refresh={}),this.refresh[e]=s),this.nextHash=e}constructor(e){this._index=1,this.view=null,this.apps={},this.ps={},this.ids=[],this.vs={},this.vps=new Map,this.url="",this.splash=!0,this.owner="",this.appName="",this.path="",this.lastOwner="",this.lastName="",this.lastPath="",this.param={},this.refresh={},this.page=null,this.hash=[],this.lastHash="",this.nextHash="",this.backed=!1,this.init=!0,this.vite=!1,this.getCurrentPage=()=>a.qu(`.${this.opt.showClass}`);let i=this,r=s({},l,e);i.opt=r,i.view=a(`#${i.opt.view}`),i.lastPage=null,i.lastApp=null,a.view=i.view,a.router=i,window.addEventListener("hashchange",e=>{var t,s,a,r;let l=o(e.newURL),n=o(e.oldURL),h=l||"index";if(l!==(h=i.repairUrl(h))){i.setHash(h);return}if(l===n){i.nextHash="";return}i.backed=!1,i.hash=i.hash||[];let p=i.hash,d=p.length;i.lastHash=d>0?p[d-1]:void 0,d>1&&p[d-2]===l?(i.backed=!0,p.pop()):i.lastHash===l||i.lastHash!==l&&p.push(l),[h]=p.slice(-1),h=null!=h?h:l;let c=null!=(r=null==(t=i.refresh)?void 0:t[h])&&r;(null==(s=i.refresh)?void 0:s[h])&&(i.refresh[h]=!1),i.routeTo(h,null==(a=i.param)?void 0:a[h],c,i.lastHash),i.nextHash=""},!1);let n=o(),h=a.urlParam();if(!n&&(null==h?void 0:h.state)){let{state:e}=h,t={};e.split("&").forEach(e=>{let s=e.split("=");t[s[0]]=s[1]});let a={};if(t.param)try{a=JSON.parse(t.param),delete t.param}catch(e){}h=s({},h,t,a),(n=t.hash)&&(n=i.repairUrl(n),delete h.hash),e&&delete h.state;let r=new URL(window.location.href);r.search="",r.hash=n,history.replaceState(null,"",r.toString())}if(n){let e=i.repairUrl(n);n!==e?i.setHash(e,h,!0):(i.hash.push(e),i.routeTo(e,h,!0),i.nextHash="")}else r.owner&&r.name&&t(function*(){yield i.switchApp(r.owner,r.name,"",h)})()}};function o(e){e||(e=i.href);let t=e.indexOf("#!");return -1!==t?t++:t=e.indexOf("#"),-1!==t?e.substring(t+1):""}function h(e){return p.apply(this,arguments)}function p(){return(p=t(function*(e){let t;if(!("DecompressionStream"in window))throw Error("DecompressionStream is not supported in this browser.");try{let s=yield fetch(e);if(!s.ok)throw Error(`HTTP error! Status: ${s.status}`);let a=s.body.pipeThrough(new DecompressionStream("gzip")),i=yield function(e){return d.apply(this,arguments)}(a);if(i&&/^\s*[{[]/.test(i))try{t=JSON.parse(i)}catch(e){}}catch(e){}return t})).apply(this,arguments)}function d(){return(d=t(function*(e){let t=e.getReader(),s=new TextDecoder,a="",i=!1;for(;!i;){let{value:e,done:r}=yield t.read();i=r,e&&(a+=s.decode(e,{stream:!0}))}return a})).apply(this,arguments)}return a.go=(e,t=null,s=!1)=>{a.router.go(e,t,s)},a.back=(e,t=!1)=>{a.router.back(e,t)},a.repairUrl=e=>a.router.repairUrl(e),n.default=n,n});