{"version":3,"file":"router.js","sources":["../src/router.js"],"sourcesContent":["/**\n * 开放、互联 前端路由\n * Released on: September 13\n */\n\n// 动画方式切换\n// import $ from '@wiajs/dom';\n\n/* global\n\n*/\n\n// const $ = window.$;\nlet location = window.location; // eslint-disable-line\n\nconst CFG = {\n  sectionGroupClass: 'page-group',\n  // 用来辅助切换时表示 page 是 visible 的,\n  // 之所以不用 curPageClass，是因为 page-current 已被赋予了「当前 page」这一含义而不仅仅是 display: block\n  // 并且，别的地方已经使用了，所以不方便做变更，故新增一个\n  visiblePageClass: 'page-visible',\n};\n\nconst DIRECTION = {\n  leftToRight: 'from-left-to-right',\n  rightToLeft: 'from-right-to-left',\n};\n\nconst EVENTS = {\n  pageLoadStart: 'pageLoadStart', // ajax 开始加载新页面前\n  pageLoadCancel: 'pageLoadCancel', // 取消前一个 ajax 加载动作后\n  pageLoadError: 'pageLoadError', // ajax 加载页面失败后\n  pageLoadComplete: 'pageLoadComplete', // ajax 加载页面完成后（不论成功与否）\n  pageAnimationStart: 'pageAnimationStart', // 动画切换 page 前\n  pageAnimationEnd: 'pageAnimationEnd', // 动画切换 page 结束后\n  beforePageRemove: 'beforePageRemove', // 移除旧 document 前（适用于非内联 page 切换）\n  pageRemoved: 'pageRemoved', // 移除旧 document 后（适用于非内联 page 切换）\n  // page 切换前，pageAnimationStart 前，beforePageSwitch后会做一些额外的处理才触发 pageAnimationStart\n  beforePageSwitch: 'beforePageSwitch',\n  pageInit: 'pageInitInternal', // 目前是定义为一个 page 加载完毕后（实际和 pageAnimationEnd 等同）\n};\n\n/**\n * a very simple router for the **demo** of [weui](https://github.com/weui/weui)\n */\nexport default class Router {}\n\n/**\n * 获取 url 的 fragment（即 hash 中去掉 # 的剩余部分）\n *\n * 如果没有则返回字符串\n * 如: http://example.com/path/?query=d#123 => 123\n *\n * @param {String} url url\n * @returns {String}\n */\nfunction getHash(url) {\n  if (!url) return '';\n\n  let pos = url.indexOf('#!');\n  if (pos !== -1) pos++;\n  else pos = url.indexOf('#');\n\n  return pos !== -1 ? url.substring(pos + 1) : ''; // ??? '/'\n}\n\n// google 支持 #! 格式\nfunction setHash(url) {\n  let hash = url;\n  if (url[0] !== '!') hash = `!${url}`;\n  location.hash = hash;\n}\n\n/**\n * 修改微信 title\n */\nfunction setTitle(val) {\n  if (document.title === val) return;\n\n  if (/MicroMessenger/i.test(navigator.userAgent)) {\n    setTimeout(() => {\n      // 利用iframe的onload事件刷新页面\n      document.title = val;\n\n      const fr = document.createElement('iframe');\n      // fr.style.visibility = 'hidden';\n      fr.style.display = 'none';\n      fr.src = 'img/favicon.ico';\n      fr.onload = () => {\n        setTimeout(() => {\n          document.body.removeChild(fr);\n        }, 0);\n      };\n      document.body.appendChild(fr);\n    }, 0);\n  } else document.title = val;\n}\n\n/**\n * 获取一个 url 的基本部分，即不包括 hash\n *\n * @param {String} url url\n * @returns {String}\n */\nfunction getBaseUrl(url) {\n  const pos = url.indexOf('#');\n  return pos === -1 ? url.slice(0) : url.slice(0, pos);\n}\n\n$.go = (url, param = null, refresh = false) => {\n  $.router.go(url, param, refresh);\n};\n\n$.back = (refresh = false) => {\n  $.router.refresh = refresh;\n  $.router.back();\n};\n"],"names":[],"mappings":";;;;;;AAAA;;;;;;;;;;;;;AAaA,IAAI,QAAQ,GAAG,MAAM,CAAC,QAAQ,CAAC;AAC/B,AA2BA;;;;AAIA,AAAe,MAAM,MAAM,CAAC,EAAE;AAC9B,AA8DA;AACA,CAAC,CAAC,EAAE,GAAG,CAAC,GAAG,EAAE,KAAK,GAAG,IAAI,EAAE,OAAO,GAAG,KAAK,KAAK;EAC7C,CAAC,CAAC,MAAM,CAAC,EAAE,CAAC,GAAG,EAAE,KAAK,EAAE,OAAO,CAAC,CAAC;CAClC,CAAC;;AAEF,CAAC,CAAC,IAAI,GAAG,CAAC,OAAO,GAAG,KAAK,KAAK;EAC5B,CAAC,CAAC,MAAM,CAAC,OAAO,GAAG,OAAO,CAAC;EAC3B,CAAC,CAAC,MAAM,CAAC,IAAI,EAAE,CAAC;CACjB,CAAC;;;;"}